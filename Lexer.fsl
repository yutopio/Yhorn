{
module Lexer

open System
open Error
open Parser
open Types

(*** Some helper functions ***)
let lexeme (lexbuf:Lexing.LexBuffer<_>) = new string(lexbuf.Lexeme)
}

let br = ['\r' '\n']
let sp = [' ' '\t']
let digit = ['0'-'9']
let letter = ['a'-'z' 'A'-'Z']
let nonEscChars = [^ '"' '\'' '\\' '0' 'n' 'r' 't']
let identChar = letter | '_'

rule token = parse
    | sp+               { token lexbuf }
    | br+               { token lexbuf }
    | "<="              { OP(LTE) }
    | ">="              { OP(GTE) }
    | "<>"              { OP(NEQ) }
    | '<'               { OP(LT) }
    | '>'               { OP(GT) }
    | '='               { OP(EQ) }
    | '+'               { PLUS }
    | '-'               { MINUS }
    | '('               { LPAREN }
    | ')'               { RPAREN }
    | '&'               { AND }
    | '|'               { OR }
    | ';'               { SEMICOLON }
    | identChar+        { IDENT(lexeme lexbuf) }
    | digit+            { INT(Int32.Parse(lexeme lexbuf)) }
    | eof               { EOF }
    | _                 { unrecToken (lexeme lexbuf) }
